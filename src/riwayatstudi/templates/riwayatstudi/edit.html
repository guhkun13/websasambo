{% extends "material-admin/base.html" %}
{% load custom_tags %}
{% load static %}

{% block css %}
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />

{% endblock %}

{% block breadcrumb %}
<!-- here you go -->
{% endblock %}

{% block content %}

<div class="col s12 m12 l12">
  {% if messages %}
  <ul class="messages">
    {% for message in messages %}
    <li {% if message.tags %} class="msg {{ message.tags }}" {% endif %}> {{ message }}</li>
    {% endfor %}
  </ul>
  {% endif %}
</div>

<div class="row">
  <div class="col s12 m12 l12">
    <div class="card card card-default scrollspy">
      <div class="card-content">
        <h5> Ubah Riwayat Studi [<b> {{request.user.username}} / {{obj.fk_jenjang_pendidikan.nama}}] </b> </h5>
        <hr />
        <form action="{% url 'riwayatstudi:save' %}" method="POST" class="form">
          {% csrf_token %}
          <input type="hidden" name='pk' value='obj.id'>
          <div class="row">
            <div class="col l6 s12">
              <label> Nomor Induk </label>
              <input name="nomor_induk_studi" type="text" class="input-field" required value={{obj.nomor_induk_studi}}>
            </div>
            <div class="col l6 s12">
              <label> Nama Instansi </label>
              <input name="nama_instansi" type="text" class="input-field" required value={{obj.nama_instansi}}>
            </div>

            <div class="col l6 s12">
              <label> Negara </label>
              <select id="negara_kuliah">
                <option value="ID"> INDONESIA </option>
                <option value="LAIN"> LUAR INDONESIA </option>
              </select>
            </div>

            <div id="negara_id">
              <div class="col l6 s12">
                <label> Provinsi </label>
                <select name="provinsi">
                  <option value="11|NTB"> NTB </option>
                  <option value="12|BALI"> BALI </option>
                </select>
              </div>

              <div class="col l6 s12">
                <label> Kabupaten </label>
                <select name="kabupaten">
                  <option value="11|LOTIM"> LOTIM </option>
                  <option value="12|LOTENG"> LOTENG </option>
                </select>
              </div>

            </div>

            <div id="negara_lain" style="display:none">
              <div class="col l6 s12">
                <label> Nama Negara </label>
                <input name="negara" type="text" class="input-field" value={{obj.nama_negara}}>
              </div>

              <div class="col l6 s12">
                <label> Alamat Kampus </label>
                <input name="alamat_kampus_luar_negeri" type="text" class="input-field"
                  value={{obj.alamat_kampus_luar_negeri}}>
              </div>

            </div>

            <div class="col l6 s12">
              <label> Ijazah Tertinggi </label>
              <select id="jenjang_pendidikan" name="jenjang_pendidikan">
                {% for data in jenjang_pendidikans %}
                <option {% if obj.jenjang_pendidikan == data %} selected {% endif %} value="{{data.id}}|{{data.jenis}}">
                  {{data.nama}}
                </option>
                {% endfor %}
              </select>
            </div>

            <div id="div_pt">
              <div class="col l6 s12">
                <label> Fakultas </label>
                <input name="fakultas" type="text" class="input-field" value={{obj.fakultas}}>

              </div>
            </div>

            <div class="col l6 s12">
              <label> Jurusan </label>
              <input name="jurusan" type="text" class="input-field" value={{obj.jurusan}}>
            </div>

            <div class="col l6 s12">
              <label> Jalur Masuk </label>
              <input name="jalur_masuk" type="text" class="input-field" value={{obj.jalur_masuk}}>
            </div>

            <div class="col l6 s12">
              <label> Tahun Masuk </label>
              <input name="tahun_masuk" type="text" class="input-field" maxlength="4" pattern="[1-2][0-9]{3}"
                value={{obj.tahun_masuk}}>
            </div>

            <div class="col l6 s12">
              <label> Tahun Keluar </label>
              <input name="tahun_masuk" type="text" class="input-field" maxlength="4" pattern="[1-2][0-9]{3}">
            </div>

            <div class="col l6 s12">
              <label> Alasan Keluar </label>
              <input name="tahun_masuk" type="text" class="input-field" value={{obj.alasan_keluar}}>
            </div>

            <div class="col l6 s12">
              <label> MENDAPAT BEASISWA </label>
              <select id="is_beasiswa">
                <option value="no"> TIDAK </option>
                <option value="yes"> YES </option>
              </select>
            </div>

            <div class="col l6 s12" id="div_nama_beasiswa" style="display: none;">
              <label> Nama Beasiswa </label>
              <input name="nama_beasiswa" type="text" class="input-field" value={{obj.nama_beasiswa}}>
            </div>

            <div class="input-field col s12">
              <button class="btn waves-effect waves-light submit" type="submit" name="action">
                Submit <i class="material-icons right">send</i>
              </button>

              <a href="{% url 'mainapp:index' %}" class="btn red " type="button" name="action">
                Cancel <i class="material-icons right">cancel</i>
              </a>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block js %}

<script>
  defaultValueJP();
  // toggle input for tempat kuliah
  $('#negara_kuliah').change(function () {
    var lokasinegara = $(this).val();
    // alert(lokasinegara);
    if (lokasinegara == "LAIN") {
      $('#negara_lain').show();
      $('#negara_id').hide();
    } else if (lokasinegara == "ID") {
      $('#negara_lain').hide();
      $('#negara_id').show();
    }
  });

  function defaultValueJP() {
    console.log("call defaultValueJP");
    let tempvalue = $('#jenjang_pendidikan').val();
    let arrVal = tempvalue.split('|');
    let value = arrVal[1];

    if (value == "PT") {
      $('#div_pt').show();
    } else if (value == "PMA") {
      $('#div_pt').hide();
    }
  }


  $('#jenjang_pendidikan').change(function () {
    let tempvalue = $(this).val();
    let arrVal = tempvalue.split('|');
    console.log(arrVal);
    let value = arrVal[1];

    // alert(lokasinegara);
    if (value == "PT") {
      $('#div_pt').show();
    } else if (value == "PMA") {
      $('#div_pt').hide();
    }
  });

  $('#is_beasiswa').change(function () {
    let value = $(this).val();
    // alert(lokasinegara);
    if (value == "yes") {
      $('#div_nama_beasiswa').show();
    } else if (value == "no") {
      $('#div_nama_beasiswa').hide();
    }
  });
</script>

{% endblock js%}